<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>定时器管理&函数封装</title>
    <style>
        #div1 {
            width:20px;
            height:20px;
            background: #000000;
            position:absolute;
            top:200px;
            left:600px;
        }
        #area{
            width:520px;
            height:320px;
            background: #b6ccf6;
            margin: 50px 0 0 342px;
        }
        #butt{
            width:520px;
            height:100px;
            background: #ae91df;
            margin-left:342px;
        }
        #btn1 ,#btn2 ,#btn3, #btn4{
            width:50px;
            height:50px;
            background: #fd864b;
            margin-top:25px;
            margin-left:60px;
        }
    </style>
</head>

<body>

<div id="area"></div>
<div id="butt">
    <input id="btn1" type="button" value="上" />
    <input id="btn2" type="button" value="下" />
    <input id="btn3" type="button" value="左" />
    <input id="btn4" type="button" value="右" />
</div>


<div id="div1"></div>

<script>
    var oBtn1 = document.getElementById('btn1');
    var oBtn2 = document.getElementById('btn2');
    var oBtn3 = document.getElementById('btn3');
    var oBtn4 = document.getElementById('btn4');
    var oDiv = document.getElementById('div1');

    oBtn1.onclick = function () {

        doMove ( oDiv, 'top', 5, 50 );

    };

    oBtn2.onclick = function () {

        doMove ( oDiv, 'top', 5, 350 );

    };
    oBtn3.onclick = function () {

        doMove ( oDiv, 'left', 5, 350 );

    };
    oBtn4.onclick = function () {

        doMove ( oDiv, 'left', 5, 850 );

    };

    function doMove ( obj, attr, dir, target ) {

        dir = parseInt(getStyle( obj, attr )) < target ? dir : -dir;

        clearInterval( obj.timer );

        obj.timer = setInterval(function () {

            var speed = parseInt(getStyle( obj, attr )) + dir;			// 步长

            if ( speed > target && dir > 0 ||  speed < target && dir < 0  ) {
//                alert('you are dead!');
                speed = target;
            }

            obj.style[attr] = speed + 'px';

            if ( speed == target ) {
                clearInterval( obj.timer );
            }

        }, 30);
    }

    function getStyle ( obj, attr ) { return obj.currentStyle?obj.currentStyle[attr] : getComputedStyle( obj )[attr]; }
</script>

</body>
</html>
